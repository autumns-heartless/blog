import{bQ as e,aM as i,w as l,x as a,J as p,L as t,I as r,aZ as h}from"./chunks/framework.D69h5UT5.js";const y=JSON.parse('{"title":"弄个 Hysteria 代理服务器","description":"","frontmatter":{"title":"弄个 Hysteria 代理服务器","date":"2024/12/11","tags":["翻墙","Hysteria"]},"headers":[],"relativePath":"2024/12/11/hysteria.md","filePath":"2024/12/11/hysteria.md","lastUpdated":1737109874000}'),c={name:"2024/12/11/hysteria.md"};function d(o,s,b,k,u,m){const n=h("ArticleMetadata");return i(),l("div",{"data-pagefind-body":!0},[s[0]||(s[0]=a("h1",{id:"弄个-hysteria-代理服务器",tabindex:"-1"},[p("弄个 Hysteria 代理服务器 "),a("a",{class:"header-anchor",href:"#弄个-hysteria-代理服务器","aria-label":'Permalink to "弄个 Hysteria 代理服务器"'},"​")],-1)),t(n,{article:{}}),s[1]||(s[1]=r(`<h2 id="序" tabindex="-1">序 <a class="header-anchor" href="#序" aria-label="Permalink to &quot;序&quot;">​</a></h2><p>2024 黑五，在 <a href="https://my.racknerd.com/aff.php?aff=13255" target="_blank" rel="noreferrer">RackNerd</a> 弄了个 VPS，随便找了个域名商弄了个域名，弄上 <a href="https://v2.hysteria.network/zh/" target="_blank" rel="noreferrer">Hysteria</a> 试试。</p><p>先用 SSH 客户端连接上 VPS，我选择用 <a href="https://bitvise.com/" target="_blank" rel="noreferrer">BitVise</a>，因为编辑 <code>config.yaml</code> 会方便一些。</p><p>然后给域名加个 A 类型的域名解析，指向 VPS 的 IP 地址。</p><table tabindex="0"><thead><tr><th>A</th><th>xxxxxx.xxx</th><th>xxx.xxx.xxx.xxx</th></tr></thead></table><h2 id="服务端" tabindex="-1">服务端 <a class="header-anchor" href="#服务端" aria-label="Permalink to &quot;服务端&quot;">​</a></h2><h3 id="安装-curl" tabindex="-1">安装 curl <a class="header-anchor" href="#安装-curl" aria-label="Permalink to &quot;安装 curl&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># curl --version</span></span>
<span class="line"><span></span></span>
<span class="line"><span>curl 7.58.0 (x86_64-pc-linux-gnu) libcurl/7.58.0 OpenSSL/1.1.1 zlib/1.2.11 libidn2/2.0.4 libpsl/0.19.1 (+libidn2/2.0.4) nghttp2/1.30.0 librtmp/2.3</span></span>
<span class="line"><span>Release-Date: 2018-01-24</span></span>
<span class="line"><span>Protocols: dict file ftp ftps gopher http https imap imaps ldap ldaps pop3 pop3s rtmp rtsp smb smbs smtp smtps telnet tftp</span></span>
<span class="line"><span>Features: AsynchDNS IDN IPv6 Largefile GSS-API Kerberos SPNEGO NTLM NTLM_WB SSL libz TLS-SRP HTTP2 UnixSockets HTTPS-proxy PSL</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="执行-hysteria-安装脚本" tabindex="-1">执行 Hysteria 安装脚本 <a class="header-anchor" href="#执行-hysteria-安装脚本" aria-label="Permalink to &quot;执行 Hysteria 安装脚本&quot;">​</a></h3><p>参见 <a href="https://v2.hysteria.network/zh/docs/getting-started/Installation/#linux" target="_blank" rel="noreferrer">Linux 服务端部署脚本</a>，执行以下脚本</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fsSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://get.hy2.sh/)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><details class="details custom-block"><summary>bash &lt;(curl -fsSL <a href="https://get.hy2.sh/" target="_blank" rel="noreferrer">https://get.hy2.sh/</a>)</summary><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># bash &lt;(curl -fsSL https://get.hy2.sh/)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Checking for installed version ... not installed</span></span>
<span class="line"><span>Checking for latest version ... v2.6.0</span></span>
<span class="line"><span>Downloading hysteria binary: https://github.com/apernet/hysteria/releases/download/app/v2.6.0/hysteria-linux-amd64 ...</span></span>
<span class="line"><span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span>
<span class="line"><span>                                  Dload  Upload   Total   Spent    Left  Speed</span></span>
<span class="line"><span>  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0</span></span>
<span class="line"><span>100 17.8M  100 17.8M    0     0  28.3M      0 --:--:-- --:--:-- --:--:-- 28.3M</span></span>
<span class="line"><span>Installing hysteria executable ... ok</span></span>
<span class="line"><span>Install /etc/hysteria/config.yaml ... ok</span></span>
<span class="line"><span>Creating user hysteria ... ok</span></span>
<span class="line"><span>Install /etc/systemd/system/hysteria-server.service ... ok</span></span>
<span class="line"><span>Install /etc/systemd/system/hysteria-server@.service ... ok</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congratulation! Hysteria 2 has been successfully installed on your server.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>What&#39;s next?</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  + Take a look at the differences between Hysteria 2 and Hysteria 1 at https://hysteria.network/docs/misc/2-vs-1/</span></span>
<span class="line"><span>  + Check out the quick server config guide at https://hysteria.network/docs/getting-started/Server/</span></span>
<span class="line"><span>  + Edit server config file at /etc/hysteria/config.yaml</span></span>
<span class="line"><span>  + Start your hysteria server with systemctl start hysteria-server.service</span></span>
<span class="line"><span>  + Configure hysteria start on system boot with systemctl enable hysteria-server.service</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></details><h3 id="编辑-config-yaml" tabindex="-1">编辑 <code>config.yaml</code> <a class="header-anchor" href="#编辑-config-yaml" aria-label="Permalink to &quot;编辑 \`config.yaml\`&quot;">​</a></h3><p>根据上一步安装完成的提示</p><blockquote><p>Edit server config file at <code>/etc/hysteria/config.yaml</code></p></blockquote><p>参照 <a href="https://v2.hysteria.network/zh/docs/getting-started/Server/" target="_blank" rel="noreferrer">服务端</a>，编辑 <code>/etc/hysteria/config.yaml</code> 文件。</p><details class="details custom-block"><summary>config.yaml</summary><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># listen: :443</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">acme</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  domains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">xxxxxxxx.xxx</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  email</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">xxxxx@xxx.xxx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">auth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">password</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">xxxxxxxxxxxxxxxx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">masquerade</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">proxy</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  proxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://www.google.com/</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    rewriteHost</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></details><p>这里的 <code>password</code> 可以用 1Password 的 <a href="https://1password.com/password-generator" target="_blank" rel="noreferrer">Password Generator</a> 生成。</p><h3 id="systemctl" tabindex="-1">systemctl <a class="header-anchor" href="#systemctl" aria-label="Permalink to &quot;systemctl&quot;">​</a></h3><p>配置好 <code>config.yaml</code> 后，用 <code>systemctl</code> 启动 hysteria：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hysteria-server.service</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hysteria-server.service</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># systemctl status hysteria-server.service</span></span>
<span class="line"><span>● hysteria-server.service - Hysteria Server Service (config.yaml)</span></span>
<span class="line"><span>   Loaded: loaded (/etc/systemd/system/hysteria-server.service; enabled; vendor preset: enabled)</span></span>
<span class="line"><span>   Active: active (running) since Tue 2024-12-10 13:54:10 GMT; 21s ago</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>服务端至此配置完。</p><h2 id="客户端" tabindex="-1">客户端 <a class="header-anchor" href="#客户端" aria-label="Permalink to &quot;客户端&quot;">​</a></h2><h3 id="windows、android" tabindex="-1">Windows、Android <a class="header-anchor" href="#windows、android" aria-label="Permalink to &quot;Windows、Android&quot;">​</a></h3><p>家里的电脑是 Windows。</p><p>我用的是 <a href="https://github.com/2dust/v2rayN" target="_blank" rel="noreferrer">v2rayN</a>，点击 <code>添加[Hysteria2]服务器</code>，然后 <code>地址</code> 填上域名，<code>密码</code>填上服务端配置的密码就行了。</p><p><img src="https://cdn.jsdelivr.net/gh/tangjan/imgBed/notes/2024/12/11/hysteria/1-v2rayN-1.png" alt="1-v2rayN-1" data-fancybox="gallery" loading="lazy"></p><p><img src="https://cdn.jsdelivr.net/gh/tangjan/imgBed/notes/2024/12/11/hysteria/2-v2rayN-2.png" alt="2-v2rayN-2" data-fancybox="gallery" loading="lazy"></p><p>Android 则是用的 <a href="https://github.com/2dust/v2rayNG" target="_blank" rel="noreferrer">v2rayNG</a>，扫描 v2rayN 生成的二维码就行了。</p><h3 id="macos" tabindex="-1">macOS <a class="header-anchor" href="#macos" aria-label="Permalink to &quot;macOS&quot;">​</a></h3><p>公司的电脑是 macOS。</p><p>在 Hysteria 的 <a href="https://github.com/apernet/hysteria/releases" target="_blank" rel="noreferrer">release</a> 页面，下载最新的 <code>hysteria-darwin-arm64</code> ，然后参照 <a href="https://v2.hysteria.network/zh/docs/getting-started/Client/" target="_blank" rel="noreferrer">客户端</a>，在 <code>hysteria-darwin-arm64</code> 同目录创建一个 <code>config.yaml</code> 文件，内容如下：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;域名&gt;:443</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">auth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;密码&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">bandwidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">20 mbps</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  down</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">100 mbps</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">socks5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  listen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">127.0.0.1:1080</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  listen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">127.0.0.1:8080</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>&lt;域名&gt;</code> 替换为自己的域名，<code>&lt;密码&gt;</code> 替换为上述在服务端配置的密码。</p><p>然后打开终端，执行 <code>./hysteria-darwin-arm64</code> 即可。</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>% ./hysteria-darwin-arm64</span></span>
<span class="line"><span></span></span>
<span class="line"><span>INFO connected to server {&quot;udpEnabled&quot;: true, &quot;tx&quot;: 2500000, &quot;count&quot;: 1}</span></span>
<span class="line"><span>INFO use this URI to share your server {&quot;uri&quot;: &quot;hysteria2://■■■■■■■■■■■■■■■■■■■■■■■■■■■■&quot;}</span></span>
<span class="line"><span>INFO HTTP proxy server listening {&quot;addr&quot;: &quot;127.0.0.1:8080&quot;}</span></span>
<span class="line"><span>INFO SOCKS5 server listening {&quot;addr&quot;: &quot;127.0.0.1:1080&quot;}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/tangjan/imgBed/notes/2024/12/11/hysteria/3-macOS.png" alt="3-macOS" data-fancybox="gallery" loading="lazy"></p><h2 id="结" tabindex="-1">结 <a class="header-anchor" href="#结" aria-label="Permalink to &quot;结&quot;">​</a></h2><p>初步体验下来感觉还行。</p><p>之前用 <a href="/blog/2023/09/01/reinstall-v2ray">v2ray</a> 套了层 Cloudflare CDN，用着挺难受的。</p>`,44))])}const v=e(c,[["render",d]]);export{y as __pageData,v as default};
